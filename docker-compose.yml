version: '3'
services:
  router:
    build: "./docker/router"
    ports:
      - "443:443"
  web:
    restart: always
    build: "./docker/web"
    volumes:
      - ./website:/var/www/html
    ports:
      - "1080:80"
  legacyweb:
    restart: always
    build: "./docker/legacyweb"
  dns:
    build:
      context: .
      dockerfile: "./docker/zdxsv/Dockerfile"
    volumes:
      - ./local.toml:/local.toml
    entrypoint:
      - /zdxsv
      - dns
      - /local.toml
    ports:
      - "53:53/udp"
  login:
    build:
      context: .
      dockerfile: "./docker/zdxsv/Dockerfile"
    volumes:
      - ./local.toml:/local.toml
      - ./zdxsv.db:/zdxsv.db
    entrypoint:
      - /zdxsv
      - login
      - /local.toml
  lobby:
    build:
      context: .
      dockerfile: "./docker/zdxsv/Dockerfile"
    ports:
      - "8200:8200"
    volumes:
      - ./local.toml:/local.toml
      - ./zdxsv.db:/zdxsv.db
    entrypoint:
      - /zdxsv
      - lobby
      - /local.toml
  battle:
    build:
      context: .
      dockerfile: "./docker/zdxsv/Dockerfile"
    ports:
      - "8210:8210"
      - "8210:8210/udp"
    volumes:
      - ./local.toml:/local.toml
    entrypoint:
      - /zdxsv
      - battle
      - /local.toml
  status:
    build:
      context: .
      dockerfile: "./docker/zdxsv/Dockerfile"
    volumes:
      - ./local.toml:/local.toml
    entrypoint:
      - /zdxsv
      - status
      - /local.toml